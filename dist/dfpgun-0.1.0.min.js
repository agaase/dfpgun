/*! dfpgun.js - v0.1.0 - 2014-03-17
* https://github.com/agaase/
* Copyright (c) 2014 agaase; Licensed MIT */
!function(){var a={},b={},c=".dfpgun",d="dfpgunned",e=function(a){console.log("dfpgun:"+(new Date).getTime()+":"+a)},f=function(){var a;if(a=a||$('script[src*="gpt.js"]').length,!a){window.googletag=window.googletag||{},window.googletag.cmd=window.googletag.cmd||[];var b=document.createElement("script");b.async=!0,b.type="text/javascript",b.onerror=function(){console.log("There is an ad blocker")};var c="https:"===document.location.protocol;b.src=(c?"https:":"http:")+"//www.googletagservices.com/tag/js/gpt.js";var d=document.getElementsByTagName("script")[0];d.parentNode.insertBefore(b,d),"none"===b.style.display&&console.log("There is an ad blocker")}},g=function(b,c){if("6"===c.getMessageId().toString()){var d=c.getMessageArgs();e("ad loaded-"+d);var f=a[d],g=f.element,i=f.callback;i&&(e("callback called"+d),i(f.element)),f.refreshed||g.is(":visible")||!f.forceRefresh||(h(f),f.refreshed=!0)}},h=function(a){googletag.cmd.push(function(){e("refreshing ad"),googletag.pubads().refresh([a.slot])})},i=function(c,d){a[c]={},a[c].callback=b.callback||void 0,a[c].element=d,a[c].forceRefresh="undefined"!=typeof b.forceRefresh?b.forceRefresh:!1},j=function(c){var f,h=c.adunit,j=c.element,k="Ad_"+parseInt(1e5*Math.random(),10),l=c.sizes;googletag=b.googletag||googletag,i(h,j),e("dfploader:Triggering ad-"+h),j.empty().attr("id",k).addClass(d),googletag.cmd.push(function(){googletag.debug_log.log=g,googletag.pubads().collapseEmptyDivs(!0),googletag.enableServices()}),googletag.cmd.push(function(){f=googletag.defineSlot(h,l,k).addService(googletag.pubads()),a[h].slot=f}),googletag.cmd.push(function(){googletag.display(k)})},k=function(){var a=[];$(c).each(function(b,c){var d=$(c).attr("data-adunit"),f=$(c).attr("data-adsize");d&&f?(f=f.split("x"),2===f.length?(f[0]=parseInt(f[0],10),f[1]=parseInt(f[1],10),a.push({adunit:d,sizes:f,element:$(c)})):e("invalid parameters for ad,skipping")):e("invalid parameters for ad,skipping")}),$.each(a,function(a,b){j(b)})};$.dfpgun=function(a){f(),b=a||{},k()}}($);